<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:int-amqp="http://www.springframework.org/schema/integration/amqp"
       xmlns:int="http://www.springframework.org/schema/integration"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:int-xml="http://www.springframework.org/schema/integration/xml"
       xsi:schemaLocation="http://www.springframework.org/schema/integration
                          http://www.springframework.org/schema/integration/spring-integration.xsd
                          http://www.springframework.org/schema/integration/amqp
                          http://www.springframework.org/schema/integration/amqp/spring-integration-amqp.xsd
                          http://www.springframework.org/schema/integration/xml
                          http://www.springframework.org/schema/integration/xml/spring-integration-xml.xsd
                          http://www.springframework.org/schema/beans
                          http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

  <int-amqp:inbound-channel-adapter id="st1Adapter" queue-names="${que.sdc.oc.st1}"
                                    connection-factory="sdcnqConsumerConnectionFactory" acknowledge-mode="AUTO"
                                    mapped-request-headers="valde_*,oc_*,X-*,stamp_uuid,last_updated,amqp_receivedRoutingKey"
                                    channel="st1Channel" error-channel="invalidMessageChannel"/>

  <util:set id="valdeRequiredHeaders" value-type="ptv.feed.sdc.sender.valde.enums.ValdeHeaders">
    <value>VALDE_GAME_ID</value>
    <value>VALDE_FEED_TYPE</value>
  </util:set>

  <util:set id="ocRequiredHeaders" value-type="ptv.feed.sdc.sender.oc.enums.OcPushHeaders">
    <value>OC_TYPE</value>
    <value>OC_FORMAT</value>
  </util:set>

  <bean id="valdeHadersValidator" class="ptv.feed.sdc.sender.valde.validator.ValdeRequiredHeadersValidator">
    <constructor-arg name="valdeRequiredHeaders" ref="valdeRequiredHeaders" />
    <constructor-arg name="ocRequiredHeaders" ref="ocRequiredHeaders" />
  </bean>

  <int:chain input-channel="st1Channel" output-channel="senderStringChannel">
    <int:header-enricher>
      <int:header name="__TypeId__" value="st1" />
    </int:header-enricher>
    <int:filter ref="valdeHadersValidator" />
  </int:chain>
</beans>